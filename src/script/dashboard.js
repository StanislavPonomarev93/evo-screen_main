const inputFile = document.querySelector('.input-button');
const resultText = document.querySelector('.result-text');
const containerBlanc = document.querySelector('.container-blanc');
const kdlBtn = document.querySelector('#kdl');
const invitroBtn = document.querySelector('#invitro');
const gemotestBtn = document.querySelector('#gemotest');
const formDashboard = document.querySelector('#form-dashboard');
const labelcd4 = document.querySelector('label[for="cd4"]');
const labelcd4p = document.querySelector('label[for="cd4p"]');
const labelcd8 = document.querySelector('label[for="cd8"]');
const labelcd8p = document.querySelector('label[for="cd8p"]');
const labelcd16 = document.querySelector('label[for="cd16"]');
const labelcd16p = document.querySelector('label[for="cd16p"]');


const loader = document.querySelector('.loader-container');
const sectionRes = document.querySelector('.section-res');
const sr2oevcbow = document.querySelector('.sr2oevcbow');
const c7fmwv8lpt = document.querySelector('.c7fmwv8lpt');
const c33a9y20m2C7fmwv8lpt = c7fmwv8lpt.querySelector('.c33a9y20m2');
const nphk4r2q57C7fmwv8lpt = c7fmwv8lpt.querySelector('.nphk4r2q57');
const oj2nrqo9n0 = document.querySelector('.oj2nrqo9n0');
const c9mo8xtd6r = document.querySelector('.c9mo8xtd6r');
const ohtf9c1j96 = document.querySelector('.ohtf9c1j96');
const eys7imxbp7All = document.querySelectorAll('.eys7imxbp7');
const rdwkp1q985 = document.querySelector('.rdwkp1q985');
const nphk4r2q57Rdwkp1q985 = rdwkp1q985.querySelector('.nphk4r2q57');
const xf3ya1xdjk = document.querySelector('.xf3ya1xdjk');
const m7je45drcy = document.querySelector('.m7je45drcy');
const ez41ri7xyz = document.querySelector('.ez41ri7xyz');
const g6f42kv6na = document.querySelector('.g6f42kv6na');
const htrkq0k4ew = document.querySelector('.htrkq0k4ew');
const nl0vqcgedy = document.querySelector('.nl0vqcgedy');
const dkhdv74yes = document.querySelector('.dkhdv74yes');
const z5ihipq9fo = document.querySelector('.z5ihipq9fo');
const c33a9y20m2Z5ihipq9fo = z5ihipq9fo.querySelector('.c33a9y20m2');
const nphk4r2q57Z5ihipq9fo = z5ihipq9fo.querySelector('.nphk4r2q57');
const ygu0vd2qix = document.querySelector('.ygu0vd2qix');
const sc0spy5cn7 = document.querySelector('.sc0spy5cn7');
const c33a9y20m2Sc0spy5cn7 = sc0spy5cn7.querySelector('.c33a9y20m2');
const nphk4r2q57Sc0spy5cn7 = sc0spy5cn7.querySelector('.nphk4r2q57');
const gd85y1tgab = document.querySelector('.gd85y1tgab');
const odbg74p8w2 = document.querySelector('.odbg74p8w2');
const x154sfne6g = document.querySelector('.x154sfne6g');
const deh407ri4s = document.querySelector('.deh407ri4s');
const ls4x2iip92 = document.querySelector('.ls4x2iip92');
const w8oztqphyc = document.querySelector('.w8oztqphyc');
const o5haj5giv1 = document.querySelector('.o5haj5giv1');
const grsjr8ocih = document.querySelector('.grsjr8ocih');
const um4ykedxe8O5haj5giv1 = o5haj5giv1.querySelectorAll('.um4ykedxe8');
const um4ykedxe8Grsjr8ocih = grsjr8ocih.querySelectorAll('.um4ykedxe8');
const uh4xnyce9z = document.querySelector('.uh4xnyce9z');
const nphk4r2q57Uh4xnyce9z = uh4xnyce9z.querySelector('.nphk4r2q57');
const c33a9y20m2Uh4xnyce9z = uh4xnyce9z.querySelector('.c33a9y20m2');
const u10xvi8c6c = document.querySelector('.u10xvi8c6c');
const s6l50wfogq = document.querySelector('.s6l50wfogq');
const p8zyj2cb8p = document.querySelector('.p8zyj2cb8p');
const a3oiiz9bttP8zyj2cb8p = p8zyj2cb8p.querySelector('.a3oiiz9btt');
const zdd8vsqhn9 = document.querySelector('.zdd8vsqhn9');
const a3oiiz9bttZdd8vsqhn9 = zdd8vsqhn9.querySelector('.a3oiiz9btt');
const nvy3n4o2cl = document.querySelector('.nvy3n4o2cl');
const nvy3n4o2clPath = nvy3n4o2cl.querySelectorAll('path');
const efmwe9mr2d = document.querySelector('.efmwe9mr2d');
const efmwe9mr2dPath = efmwe9mr2d.querySelectorAll('path');
const esw4rl0sov = document.querySelector('.esw4rl0sov');
const c33a9y20m2Esw4rl0sov = esw4rl0sov.querySelector('.c33a9y20m2');
const nphk4r2q57Esw4rl0sov = esw4rl0sov.querySelector('.nphk4r2q57');
const jei77xbxw0 = document.querySelector('.jei77xbxw0');
const c33a9y20m2Jei77xbxw0 = jei77xbxw0.querySelector('.c33a9y20m2');
const nphk4r2q57Jei77xbxw0 = jei77xbxw0.querySelector('.nphk4r2q57');
const b3m2o82mj5 = document.querySelector('.b3m2o82mj5');
const v0y8rsdfm9 = document.querySelector('.v0y8rsdfm9');
const nbloht8pg2 = document.querySelector('.nbloht8pg2');
const xjdnixasw4 = document.querySelector('.xjdnixasw4');
const c33a9y20m2Xjdnixasw4 = xjdnixasw4.querySelector('.c33a9y20m2');
const nphk4r2q57Xjdnixasw4 = xjdnixasw4.querySelector('.nphk4r2q57');
const vg8bvmk841 = document.querySelector('.vg8bvmk841');
const iVg8bvmk841 = vg8bvmk841.querySelectorAll('i');
const r01knrfevh = document.querySelector('.r01knrfevh');
const x65cyczt4k = document.querySelector('.x65cyczt4k');
const y98eg3xezw = document.querySelector('.y98eg3xezw');
const h9bztcto6t = document.querySelector('.h9bztcto6t');

const textStatus = {
  a: 'Идеальный',
  b: 'Нормальный',
  c: 'Средний',
  d: 'Слабый',
  e: 'Очень слабый'
}

let cd4 = 1;
let cd4p = 1;
let cd8 = 1;
let cd8p = 1;
let cd16 = 1;
let cd16p = 1;



const resultValue = () => {
  formDashboard.cd4.value = cd4;
  formDashboard.cd4p.value = cd4p;
  formDashboard.cd8.value = cd8;
  formDashboard.cd8p.value = cd8p;
  formDashboard.cd16.value = cd16;
  formDashboard.cd16p.value = cd16p;
  funcCalc({
    cd4,
    cd4p,
    cd8,
    cd8p,
    cd16,
    cd16p
  });
  inputFile.value = '';
  loader.id = '';
}

const kdlValueName = () => {
  formDashboard.classList.remove('form_hidden');
  labelcd4.textContent = 'Т-хелперы CD3/CD4';
  labelcd4p.textContent = 'Т-хелперы CD3/CD4, %';
  labelcd8.textContent = 'Т-цитотоксические CD3/CD8';
  labelcd8p.textContent = 'Т-цитотоксические CD3/CD8, %';
  labelcd16.textContent = 'Т-киллеры(Т-NK) CD3/CD16/CD56 ';
  labelcd16p.textContent = 'Т-киллеры(Т-NK) CD3/CD16/CD56, %';
}
const invitroValueName = () => {
  formDashboard.classList.remove('form_hidden');
  labelcd4.textContent = 'T-хелперы (CD3+CD4+)';
  labelcd4p.textContent = 'T- хелперы (CD3+CD4+), %';
  labelcd8.textContent = 'T-цитотокс. (CD3+CD8+)';
  labelcd8p.textContent = 'T- цитотокс. (CD3+CD8+), %';
  labelcd16.textContent = 'EKK (CD3-CD16+CD56+)';
  labelcd16p.textContent = 'EKK (CD3-CD16+CD56+), %';
}
const gemotestValueName = () => {
  formDashboard.classList.remove('form_hidden');
  labelcd4.textContent = 'CD3+ CD4+ - клетки (T-хелперы)';
  labelcd4p.textContent = 'CD3+ CD4+ - клетки (T-хелперы)';
  labelcd8.textContent = 'CD3+ CD8+ - клетки (цитотоксические лимфоциты)';
  labelcd8p.textContent = 'CD3+ CD8+ - клетки (цитотоксические лимфоциты)';
  labelcd16.textContent = 'CD16';
  labelcd16p.textContent = 'CD16 %';
}

kdlBtn.addEventListener('click', (e) => {
  e.preventDefault();
  resultText.textContent = '';
  kdlValueName();
});
invitroBtn.addEventListener('click', (e) => {
  e.preventDefault();
  resultText.textContent = '';
  invitroValueName();
});
gemotestBtn.addEventListener('click', (e) => {
  e.preventDefault();
  resultText.textContent = '';
  gemotestValueName();
});


const kdl = (text) => {
  if (text.includes('CD3/CD4 ')) {
    cd4 = text.slice(text.indexOf('CD3/CD4 ') + 'CD3/CD4 '.length);
    cd4 = cd4.slice(0, cd4.indexOf(cd4.match(/[^.\d]+/)[0]));
    cd16 = Math.floor(cd4 / 5 * 1000) / 1000;
  }
  if (text.includes('CD3/CD4, % ')) {
    cd4p = text.slice(text.indexOf('CD3/CD4, % ') + 'CD3/CD4, % '.length);
    cd4p = cd4p.slice(0, cd4p.indexOf(cd4p.match(/[^.\d]+/)[0]));
    cd16p = Math.floor(cd4p / 5 * 1000) / 1000;
  }
  if (text.includes('CD3/CD8 ')) {
    cd8 = text.slice(text.indexOf('CD3/CD8 ') + 'CD3/CD8 '.length);
    cd8 = cd8.slice(0, cd8.indexOf(cd8.match(/[^.\d]+/)[0]));
  }
  if (text.includes('е CD3/CD8, % ')) {
    cd8p = text.slice(text.indexOf('е CD3/CD8, % ') + 'е CD3/CD8, % '.length);
    cd8p = cd8p.slice(0, cd8p.indexOf(cd8p.match(/[^.\d]+/)[0]));
  }
  if (text.includes('CD3/CD16/CD56  ')) {
    cd16 = text.slice(text.indexOf('CD3/CD16/CD56  ') + 'CD3/CD16/CD56  '.length);
    cd16 = cd16.slice(0, cd16.indexOf(cd16.match(/[^.\d]+/)[0]));
  }
  if (text.includes('CD3/CD16/CD56, % ')) {
    cd16p = text.slice(text.indexOf('CD3/CD16/CD56, % ') + 'CD3/CD16/CD56, % '.length);
    cd16p = cd16p.slice(0, cd16p.indexOf(cd16p.match(/[^.\d]+/)[0]));
  }
}

const invitro = (text) => {
  if (text.includes('(CD3+CD4+) ')) {
    cd4 = text.slice(text.indexOf('(CD3+CD4+) ') + '(CD3+CD4+) '.length);
    cd4 = cd4.slice(0, cd4.indexOf(cd4.match(/[^.\d]+/)[0]));
    cd16 = Math.floor(cd4 / 5 * 1000) / 1000;
  }
  if (text.includes('(CD3+CD4+), %')) {
    cd4p = text.slice(text.indexOf('(CD3+CD4+), % ') + '(CD3+CD4+), % '.length);
    cd4p = cd4p.slice(0, cd4p.indexOf(cd4p.match(/[^.\d]+/)[0]));
    cd16p = Math.floor(cd4p / 5 * 1000) / 1000;
  }
  if (text.includes('(CD3+CD8+) ')) {
    cd8 = text.slice(text.indexOf('(CD3+CD8+) ') + '(CD3+CD8+) '.length);
    cd8 = cd8.slice(0, cd8.indexOf(cd8.match(/[^.\d]+/)[0]));
  }
  if (text.includes('(CD3+CD8+), % ')) {
    cd8p = text.slice(text.indexOf('(CD3+CD8+), % ') + '(CD3+CD8+), % '.length);
    cd8p = cd8p.slice(0, cd8p.indexOf(cd8p.match(/[^.\d]+/)[0]));
  }
  if (text.includes('EKK (CD3-CD16+CD56+) ')) {
    cd16 = text.slice(text.indexOf('EKK (CD3-CD16+CD56+) ') + 'EKK (CD3-CD16+CD56+) '.length);
    cd16 = cd16.slice(0, cd16.indexOf(cd16.match(/[^.\d]+/)[0]));
  }
  if (text.includes('EKK (CD3-CD16+CD56+), % ')) {
    cd16p = text.slice(text.indexOf('EKK (CD3-CD16+CD56+), % ') + 'EKK (CD3-CD16+CD56+), % '.length);
    cd16p = cd16p.slice(0, cd16p.indexOf(cd16p.match(/[^.\d]+/)[0]));
  }
}

const gemotest = (text) => {
  if (text.includes('CD3+ CD4+ - клетки (T-хелперы) ')) {
    cd4 = text.slice(text.indexOf('CD3+ CD4+ - клетки (T-хелперы) ') + 'CD3+ CD4+ - клетки (T-хелперы) '.length);
    cd4p = cd4.slice(cd4.indexOf('CD3+ CD4+ - клетки (T-хелперы) ') + 'CD3+ CD4+ - клетки (T-хелперы) '.length);
    cd4 = cd4.slice(0, cd4.indexOf(cd4.match(/[^.\d]+/)[0]));
    cd4p = cd4p.slice(0, cd4p.indexOf(cd4p.match(/[^.\d]+/)[0]));
    cd16 = Math.floor(cd4 / 5 * 1000) / 1000;
    cd16p = Math.floor(cd4p / 5 * 1000) / 1000;
  }

  if (text.includes('CD3+ CD8+ - клетки (цитотоксические лимфоциты) ')) {
    cd8 = text.slice(text.indexOf('CD3+ CD8+ - клетки (цитотоксические лимфоциты) ') + 'CD3+ CD8+ - клетки (цитотоксические лимфоциты) '.length);
    cd8p = cd8.slice(cd8.indexOf('CD3+ CD8+ - клетки (цитотоксические лимфоциты) ') + 'CD3+ CD8+ - клетки (цитотоксические лимфоциты) '.length);
    cd8 = cd8.slice(0, cd8.indexOf(cd8.match(/[^.\d]+/)[0]));
    cd8p = cd8p.slice(0, cd8p.indexOf(cd8p.match(/[^.\d]+/)[0]));
  }
}

const pdfToText = (data) => {
  if (!data.includes('application/pdf')) {
    resultText.textContent = 'Этот файл не поддерживается';
    inputFile.value = '';
    loader.id = '';
    return;
  }
  pdfjsLib.getDocument(data)
    .promise.then(async (pdf) => {
      outerloop:
      for (let i = 1; i <= pdf._pdfInfo.numPages; i++) {
        let page_text = "";
        await pdf.getPage(i).then(async (page) => {
          await page.getTextContent().then((textContent) => {
            textContent.items.forEach((item) => page_text += item.str);
            return;
          });
          return;
        })

        // resultText.textContent = page_text;

        if (page_text.includes('(CD3+CD4+)')) {
          invitro(page_text);
          invitroValueName();
          resultValue();
          break outerloop;
        }
        if (page_text.includes('CD3+ CD4+')) {
          gemotest(page_text);
          gemotestValueName();
          resultValue();
          break outerloop;
        }
        if (page_text.includes('CD3/CD4')) {
          kdl(page_text);
          kdlValueName();
          resultValue();
          break outerloop;
        }
        if (i === pdf._pdfInfo.numPages) {
          funcCalc({
            cd4,
            cd4p,
            cd8,
            cd8p,
            cd16,
            cd16p
          });
          resultText.textContent = 'Не получилось обработать файл. Введите значения вручную';
          inputFile.value = '';
          loader.id = '';
        }
      }
    });
};

inputFile.addEventListener('change', (e) => {
  loader.id = 'loader-open';
  resultText.textContent = '';
  let reader = new FileReader();
  reader.readAsDataURL(e.target.files[0]);
  reader.onload = () => {
    pdfToText(reader.result)
  };
})

function mc6p9dkj1j(num) {
  iVg8bvmk841.forEach(el => {
    el.classList = '';
    el.id = '';
  });
  if (num > 80) {
    iVg8bvmk841[0].classList.add('boxShadow');
    ez41ri7xyz.textContent = '1,0';
  } else if (num > 70) {
    iVg8bvmk841[1].classList.add('boxShadow');
    ez41ri7xyz.textContent = '0,9';
    iVg8bvmk841[0].id = 'm66wjo8803';
  } else if (num > 60) {
    iVg8bvmk841[2].classList.add('boxShadow');
    ez41ri7xyz.textContent = '0,9';
    iVg8bvmk841[0].id = 'm66wjo8803';
    iVg8bvmk841[1].id = 'm66wjo8803';
  } else if (num > 50) {
    iVg8bvmk841[3].classList.add('boxShadow');
    ez41ri7xyz.textContent = '0,8';
    iVg8bvmk841[0].id = 'm66wjo8803';
    iVg8bvmk841[1].id = 'm66wjo8803';
    iVg8bvmk841[2].id = 'm66wjo8803';
  } else if (num > 40) {
    iVg8bvmk841[4].classList.add('boxShadow');
    ez41ri7xyz.textContent = '0,8';
    for (let i = 0; i < iVg8bvmk841.length - 16; i++) {
      iVg8bvmk841[i].id = 'm66wjo8803';
    }
  } else if (num > 35) {
    iVg8bvmk841[5].classList.add('boxShadow');
    ez41ri7xyz.textContent = '0,7';
    for (let i = 0; i < iVg8bvmk841.length - 15; i++) {
      iVg8bvmk841[i].id = 'm66wjo8803';
    }
  } else if (num > 30) {
    iVg8bvmk841[6].classList.add('boxShadow');
    ez41ri7xyz.textContent = '0,7';
    for (let i = 0; i < iVg8bvmk841.length - 14; i++) {
      iVg8bvmk841[i].id = 'm66wjo8803';
    }
  } else if (num > 25) {
    iVg8bvmk841[7].classList.add('boxShadow');
    ez41ri7xyz.textContent = '0,6';
    for (let i = 0; i < iVg8bvmk841.length - 13; i++) {
      iVg8bvmk841[i].id = 'm66wjo8803';
    }
  } else if (num > 20) {
    iVg8bvmk841[8].classList.add('boxShadow');
    ez41ri7xyz.textContent = '0,6';
    for (let i = 0; i < iVg8bvmk841.length - 12; i++) {
      iVg8bvmk841[i].id = 'm66wjo8803';
    }
  } else if (num > 18) {
    iVg8bvmk841[9].classList.add('boxShadow');
    ez41ri7xyz.textContent = '0,5';
    for (let i = 0; i < iVg8bvmk841.length - 11; i++) {
      iVg8bvmk841[i].id = 'm66wjo8803';
    }
  } else if (num > 16) {
    iVg8bvmk841[10].classList.add('boxShadow');
    ez41ri7xyz.textContent = '0,5';
    for (let i = 0; i < iVg8bvmk841.length - 10; i++) {
      iVg8bvmk841[i].id = 'm66wjo8803';
    }
  } else if (num > 14) {
    iVg8bvmk841[11].classList.add('boxShadow');
    ez41ri7xyz.textContent = '0,4';
    for (let i = 0; i < iVg8bvmk841.length - 9; i++) {
      iVg8bvmk841[i].id = 'm66wjo8803';
    }
  } else if (num > 12) {
    iVg8bvmk841[12].classList.add('boxShadow');
    ez41ri7xyz.textContent = '0,4';
    for (let i = 0; i < iVg8bvmk841.length - 8; i++) {
      iVg8bvmk841[i].id = 'm66wjo8803';
    }
  } else if (num > 10) {
    iVg8bvmk841[13].classList.add('boxShadow');
    ez41ri7xyz.textContent = '0,3';
    for (let i = 0; i < iVg8bvmk841.length - 7; i++) {
      iVg8bvmk841[i].id = 'm66wjo8803';
    }
  } else if (num > 8) {
    iVg8bvmk841[14].classList.add('boxShadow');
    ez41ri7xyz.textContent = '0,3';
    for (let i = 0; i < iVg8bvmk841.length - 6; i++) {
      iVg8bvmk841[i].id = 'm66wjo8803';
    }
  } else if (num > 6) {
    iVg8bvmk841[15].classList.add('boxShadow');
    ez41ri7xyz.textContent = '0,2';
    for (let i = 0; i < iVg8bvmk841.length - 5; i++) {
      iVg8bvmk841[i].id = 'm66wjo8803';
    }
  } else if (num > 4) {
    iVg8bvmk841[16].classList.add('boxShadow');
    ez41ri7xyz.textContent = '0,2';
    for (let i = 0; i < iVg8bvmk841.length - 4; i++) {
      iVg8bvmk841[i].id = 'm66wjo8803';
    }
  } else if (num > 2) {
    iVg8bvmk841[17].classList.add('boxShadow');
    ez41ri7xyz.textContent = '0,1';
    for (let i = 0; i < iVg8bvmk841.length - 3; i++) {
      iVg8bvmk841[i].id = 'm66wjo8803';
    }
  } else if (num > 1) {
    iVg8bvmk841[18].classList.add('boxShadow');
    ez41ri7xyz.textContent = '0,1';
    for (let i = 0; i < iVg8bvmk841.length - 2; i++) {
      iVg8bvmk841[i].id = 'm66wjo8803';
    }
  } else {
    iVg8bvmk841[19].classList.add('boxShadow');
    ez41ri7xyz.textContent = '0,1';
    for (let i = 0; i < iVg8bvmk841.length - 1; i++) {
      iVg8bvmk841[i].id = 'm66wjo8803';
    }
  }
}
function probability(num) {
  if (num > 80) {
    c33a9y20m2Xjdnixasw4.textContent = 'Высокая вероятность';
    nphk4r2q57Xjdnixasw4.classList.add('backgroundBlueViolet');
    ez41ri7xyz.classList.add('colorBlueViolet');
  } else if (num > 40) {
    c33a9y20m2Xjdnixasw4.textContent = 'Выше среднего';
    nphk4r2q57Xjdnixasw4.classList.add('backgroundFuchsia');
    ez41ri7xyz.classList.add('colorFuchsia');
  } else if (num > 20) {
    c33a9y20m2Xjdnixasw4.textContent = 'Средняя вероятность';
    nphk4r2q57Xjdnixasw4.classList.add('backgroundOrange');
    ez41ri7xyz.classList.add('colorOrange');
  } else if (num > 10) {
    c33a9y20m2Xjdnixasw4.textContent = 'Ниже среднего';
    nphk4r2q57Xjdnixasw4.classList.add('backgroundLightGreen');
    ez41ri7xyz.classList.add('colorLightGreen');
  } else {
    c33a9y20m2Xjdnixasw4.textContent = 'Низкая вероятность';
    nphk4r2q57Xjdnixasw4.classList.add('backgroundGreen');
    ez41ri7xyz.classList.add('colorGreen');
  }
}

function percentages(arr, str, crl, ic, num, ind) {
  arr.forEach(el => el.style.strokeDashoffset = '110');
  if (num > 30) {
    str.classList.add('colorBlueViolet');
    crl.classList.add('backgroundBlueViolet');
    ic.classList.add('colorBlueVioletPath');
    ind === 1 ? c33a9y20m2Esw4rl0sov.textContent = 'Высокий' : false;
    ind === 2 ? c33a9y20m2Jei77xbxw0.textContent = 'Высокая' : false;
  } else if (num > 20) {
    str.classList.add('colorFuchsia');
    crl.classList.add('backgroundFuchsia');
    ic.classList.add('colorFuchsiaPath');
    ind === 1 ? c33a9y20m2Esw4rl0sov.textContent = 'Выше среднего' : false;
    ind === 2 ? c33a9y20m2Jei77xbxw0.textContent = 'Выше среднего' : false;
  } else if (num > 10) {
    str.classList.add('colorOrange');
    crl.classList.add('backgroundOrange');
    ic.classList.add('colorOrangePath');
    ind === 1 ? c33a9y20m2Esw4rl0sov.textContent = 'Средний' : false;
    ind === 2 ? c33a9y20m2Jei77xbxw0.textContent = 'Средняя' : false;
  } else if (num > 5) {
    str.classList.add('colorLightGreen');
    crl.classList.add('backgroundLightGreen');
    ic.classList.add('colorLightGreenPath');
    ind === 1 ? c33a9y20m2Esw4rl0sov.textContent = 'Ниже среднего' : false;
    ind === 2 ? c33a9y20m2Jei77xbxw0.textContent = 'Ниже среднего' : false;
  } else {
    str.classList.add('colorGreen');
    crl.classList.add('backgroundGreen');
    ic.classList.add('colorGreenPath');
    ind === 1 ? c33a9y20m2Esw4rl0sov.textContent = 'Низкий' : false;
    ind === 2 ? c33a9y20m2Jei77xbxw0.textContent = 'Низкая' : false;
  }
  if (num > 30) {
    arr[5].style.strokeDashoffset = (110 - (num * 1.1)).toFixed();
    arr[4].style.strokeDashoffset = '0';
    arr[3].style.strokeDashoffset = '0';
    arr[2].style.strokeDashoffset = '0';
    arr[1].style.strokeDashoffset = '0';
    arr[0].style.strokeDashoffset = '0';
  } else if (num > 20) {
    arr[4].style.strokeDashoffset = (110 - (num * 110 / 30)).toFixed();
    arr[3].style.strokeDashoffset = '0';
    arr[2].style.strokeDashoffset = '0';
    arr[1].style.strokeDashoffset = '0';
    arr[0].style.strokeDashoffset = '0';
  } else if (num > 15) {
    arr[3].style.strokeDashoffset = (110 - (num * 5.5)).toFixed();
    arr[2].style.strokeDashoffset = '0';
    arr[1].style.strokeDashoffset = '0';
    arr[0].style.strokeDashoffset = '0';
  } else if (num > 10) {
    arr[2].style.strokeDashoffset = (110 - (num * 110 / 15)).toFixed();
    arr[1].style.strokeDashoffset = '0';
    arr[0].style.strokeDashoffset = '0';
  } else if (num > 5) {
    arr[1].style.strokeDashoffset = (110 - (num * 11)).toFixed();
    arr[0].style.strokeDashoffset = '0';
  } else {
    arr[0].style.strokeDashoffset = 109;
  }
}



const funcCalc = (obj) => {
  const {
    cd4,
    cd4p,
    cd8,
    cd8p,
    cd16,
    cd16p
  } = obj


  const iEvoScreen = cd8p / cd4p;
  const pi = Math.floor(cd4 / cd8 * 100 - 60);
  loader.id = 'loader-open';
  nphk4r2q57C7fmwv8lpt.classList = 'nphk4r2q57';
  sr2oevcbow.classList = 'sr2oevcbow';
  eys7imxbp7All.forEach(el => el.classList = 'eys7imxbp7');
  um4ykedxe8O5haj5giv1.forEach(el => el.classList = 'um4ykedxe8');
  um4ykedxe8Grsjr8ocih.forEach(el => el.classList = 'um4ykedxe8');
  nphk4r2q57Rdwkp1q985.classList = 'nphk4r2q57';
  xf3ya1xdjk.classList = 'xf3ya1xdjk';
  m7je45drcy.classList = 'm7je45drcy';
  g6f42kv6na.classList = 'g6f42kv6na';
  htrkq0k4ew.classList = 'htrkq0k4ew';
  nl0vqcgedy.classList = 'nl0vqcgedy';
  dkhdv74yes.classList = 'dkhdv74yes';
  nphk4r2q57Z5ihipq9fo.classList = 'nphk4r2q57';
  ygu0vd2qix.classList = 'ygu0vd2qix';
  nphk4r2q57Sc0spy5cn7.classList = 'nphk4r2q57';
  gd85y1tgab.classList = 'gd85y1tgab';
  odbg74p8w2.classList = 'odbg74p8w2';
  x154sfne6g.classList = 'x154sfne6g';
  deh407ri4s.classList = 'deh407ri4s';
  ls4x2iip92.classList = 'ls4x2iip92';
  w8oztqphyc.classList = 'w8oztqphyc';
  s6l50wfogq.classList = 's6l50wfogq';
  nphk4r2q57Uh4xnyce9z.classList = 'nphk4r2q57';
  a3oiiz9bttP8zyj2cb8p.classList = 'a3oiiz9btt';
  a3oiiz9bttZdd8vsqhn9.classList = 'a3oiiz9btt';
  nphk4r2q57Esw4rl0sov.classList = 'nphk4r2q57';
  nphk4r2q57Jei77xbxw0.classList = 'nphk4r2q57';
  b3m2o82mj5.classList = 'b3m2o82mj5';
  v0y8rsdfm9.classList = 'v0y8rsdfm9';
  nphk4r2q57Xjdnixasw4.classList = 'nphk4r2q57';
  ez41ri7xyz.classList = 'ez41ri7xyz';
  r01knrfevh.classList = 'r01knrfevh';
  x65cyczt4k.classList = 'x65cyczt4k';
  y98eg3xezw.classList = 'y98eg3xezw';

  if (pi > 130) {
    nphk4r2q57C7fmwv8lpt.classList.add('backgroundGreen');
    nphk4r2q57Rdwkp1q985.classList.add('backgroundViolet');
    xf3ya1xdjk.classList.add('colorVioletPath');
    sr2oevcbow.classList.add('colorGreen');
    m7je45drcy.classList.add('colorGreenPath');
    c33a9y20m2C7fmwv8lpt.textContent = textStatus.a;
    oj2nrqo9n0.textContent = 'Не рекомендуется!';
    eys7imxbp7All[0].classList.add('kqhqot9frt');
    c33a9y20m2Sc0spy5cn7.textContent = 'Эффективность оптимальная';
    nphk4r2q57Sc0spy5cn7.classList.add('backgroundGreen');
    gd85y1tgab.classList.add('colorGreenPath');
    w8oztqphyc.classList.add('wrei9370xd');
    um4ykedxe8O5haj5giv1[4].classList.add('zi1q611mda');
    h9bztcto6t.textContent = 'Для Вашего профиля риск вакцинации выше пользы.';
  } else if (pi > 110) {
    eys7imxbp7All[1].classList.add('wuqovg3e6w');
    nphk4r2q57C7fmwv8lpt.classList.add('backgroundLightGreen');
    nphk4r2q57Rdwkp1q985.classList.add('backgroundGreen');
    xf3ya1xdjk.classList.add('colorGreenPath');
    sr2oevcbow.classList.add('colorLightGreen');
    m7je45drcy.classList.add('colorLightGreenPath');
    c33a9y20m2C7fmwv8lpt.textContent = textStatus.b;
    oj2nrqo9n0.textContent = 'Рекомендуется!';
    c33a9y20m2Sc0spy5cn7.textContent = 'Эффективность хорошая';
    nphk4r2q57Sc0spy5cn7.classList.add('backgroundLightGreen');
    gd85y1tgab.classList.add('colorLightGreenPath');
    ls4x2iip92.classList.add('wrei9370xd');
    um4ykedxe8O5haj5giv1[3].classList.add('zi1q611mda');
    h9bztcto6t.textContent = 'Для Вашего профиля польза вакцинации выше риска.';
  } else if (pi > 90) {
    eys7imxbp7All[1].classList.add('wuqovg3e6w');
    nphk4r2q57C7fmwv8lpt.classList.add('backgroundOrange');
    nphk4r2q57Rdwkp1q985.classList.add('backgroundGreen');
    xf3ya1xdjk.classList.add('colorGreenPath');
    sr2oevcbow.classList.add('colorOrange');
    m7je45drcy.classList.add('colorOrangePath');
    c33a9y20m2C7fmwv8lpt.textContent = textStatus.c;
    oj2nrqo9n0.textContent = 'Рекомендуется!';
    c33a9y20m2Sc0spy5cn7.textContent = 'Эффективность умерена снижена';
    nphk4r2q57Sc0spy5cn7.classList.add('backgroundOrange');
    gd85y1tgab.classList.add('colorOrangePath');
    deh407ri4s.classList.add('wrei9370xd');
    um4ykedxe8O5haj5giv1[2].classList.add('zi1q611mda');
    h9bztcto6t.textContent = 'Для Вашего профиля польза вакцинации выше риска.';
  } else if (pi > 70) {
    eys7imxbp7All[1].classList.add('wuqovg3e6w');
    nphk4r2q57C7fmwv8lpt.classList.add('backgroundFuchsia');
    nphk4r2q57Rdwkp1q985.classList.add('backgroundViolet');
    xf3ya1xdjk.classList.add('colorVioletPath');
    sr2oevcbow.classList.add('colorFuchsia');
    m7je45drcy.classList.add('colorFuchsiaPath');
    c33a9y20m2C7fmwv8lpt.textContent = textStatus.d;
    oj2nrqo9n0.textContent = 'Рекомендуется!';
    c33a9y20m2Sc0spy5cn7.textContent = 'Эффективность значительно снижена';
    nphk4r2q57Sc0spy5cn7.classList.add('backgroundFuchsia');
    gd85y1tgab.classList.add('colorFuchsiaPath');
    x154sfne6g.classList.add('wrei9370xd');
    um4ykedxe8O5haj5giv1[1].classList.add('zi1q611mda');
    h9bztcto6t.textContent = 'Для Вашего профиля польза вакцинации выше риска.';
  } else {
    eys7imxbp7All[2].classList.add('zpzxqzqk8t');
    nphk4r2q57C7fmwv8lpt.classList.add('backgroundBlueViolet');
    nphk4r2q57Rdwkp1q985.classList.add('backgroundViolet');
    xf3ya1xdjk.classList.add('colorVioletPath');
    sr2oevcbow.classList.add('colorBlueViolet');
    m7je45drcy.classList.add('colorBlueVioletPath');
    c33a9y20m2C7fmwv8lpt.textContent = textStatus.e;
    oj2nrqo9n0.textContent = 'Не рекомендуется!';
    c33a9y20m2Sc0spy5cn7.textContent = 'Эффективность околонулевая';
    nphk4r2q57Sc0spy5cn7.classList.add('backgroundBlueViolet');
    gd85y1tgab.classList.add('colorBlueVioletPath');
    odbg74p8w2.classList.add('wrei9370xd');
    um4ykedxe8O5haj5giv1[0].classList.add('zi1q611mda');
    h9bztcto6t.textContent = 'Для Вашего профиля риск вакцинации выше пользы.';
  }
  if (pi > 200) {
    sr2oevcbow.textContent = 200;
    ohtf9c1j96.style.transform = 'rotate(53deg)';
    c9mo8xtd6r.style.strokeDashoffset = 0;
  } else {
    c9mo8xtd6r.style.strokeDashoffset = 600 - (pi * 3) + 15;
    sr2oevcbow.textContent = pi;
    ohtf9c1j96.style.transform = `rotate(${-127 + pi * 0.9}deg)`;
  }
  if (iEvoScreen <= 0.59) {
    g6f42kv6na.classList.add('colorGreen');
    dkhdv74yes.classList.add('wrei9370xd');
    c33a9y20m2Z5ihipq9fo.textContent = 'Низкий';
    nphk4r2q57Z5ihipq9fo.classList.add('backgroundGreen');
    ygu0vd2qix.classList.add('colorGreenPath');
    y98eg3xezw.classList.add('colorGreenPath');
  } else if (iEvoScreen <= 0.79) {
    g6f42kv6na.classList.add('colorOrange');
    nl0vqcgedy.classList.add('wrei9370xd');
    c33a9y20m2Z5ihipq9fo.textContent = 'Наблюдать в динамике';
    nphk4r2q57Z5ihipq9fo.classList.add('backgroundOrange');
    ygu0vd2qix.classList.add('colorOrangePath');
    x65cyczt4k.classList.add('colorOrangePath');
  } else {
    g6f42kv6na.classList.add('colorViolet');
    htrkq0k4ew.classList.add('wrei9370xd');
    c33a9y20m2Z5ihipq9fo.textContent = 'Высокий';
    nphk4r2q57Z5ihipq9fo.classList.add('backgroundBlueViolet');
    ygu0vd2qix.classList.add('colorVioletPath');
    r01knrfevh.classList.add('colorVioletPath');
  }
  g6f42kv6na.textContent = iEvoScreen.toFixed(2).split('.').join(',');
  if (pi > 200) {
    um4ykedxe8Grsjr8ocih[4].classList.add('zi1q611mda');
    u10xvi8c6c.style.width = '100%';
    c33a9y20m2Uh4xnyce9z.textContent = 'Вмешательство противопоказано, консультация иммунолога-аллерголога';
    s6l50wfogq.classList.add('colorGreenPath');
    nphk4r2q57Uh4xnyce9z.classList.add('backgroundGreen');
  } else if (pi > 150) {
    um4ykedxe8Grsjr8ocih[3].classList.add('zi1q611mda');
    u10xvi8c6c.style.width = '75%';
    c33a9y20m2Uh4xnyce9z.textContent = 'Не требует вмешательство в иммунитет';
    s6l50wfogq.classList.add('colorLightGreenPath');
    nphk4r2q57Uh4xnyce9z.classList.add('backgroundLightGreen');
  } else if (pi > 100) {
    um4ykedxe8Grsjr8ocih[2].classList.add('zi1q611mda');
    u10xvi8c6c.style.width = '50%';
    c33a9y20m2Uh4xnyce9z.textContent = 'Рекомендована повышающая иммунокорекция в группах риска, здоровым - нет';
    s6l50wfogq.classList.add('colorOrangePath');
    nphk4r2q57Uh4xnyce9z.classList.add('backgroundOrange');
  } else if (pi > 50) {
    um4ykedxe8Grsjr8ocih[1].classList.add('zi1q611mda');
    u10xvi8c6c.style.width = '25%';
    c33a9y20m2Uh4xnyce9z.textContent = 'Обязательно рекомендована всем группам';
    s6l50wfogq.classList.add('colorFuchsiaPath');
    nphk4r2q57Uh4xnyce9z.classList.add('backgroundFuchsia');
  } else {
    um4ykedxe8Grsjr8ocih[0].classList.add('zi1q611mda');
    u10xvi8c6c.style.width = '1%';
    c33a9y20m2Uh4xnyce9z.textContent = 'Длительная иммунокоррекция';
    s6l50wfogq.classList.add('colorBlueVioletPath');
    nphk4r2q57Uh4xnyce9z.classList.add('backgroundBlueViolet');
  }
  if (2 - (cd4 / cd8) > 100) {
    let newv4 = 97 + (2 - (cd4 / cd8));
    let rch = 97 + (2 - (cd4 / cd8)) * (cd16p * cd16);
    newv4 = newv4 > 0 ? newv4 : 0;
    rch = rch > 0 ? rch : 0;
    const on = Math.floor(30 + (1 - (cd4 / cd8)) * 100 / (cd16p * cd16));
    a3oiiz9bttP8zyj2cb8p.textContent = newv4.toFixed(1) + '%';
    a3oiiz9bttZdd8vsqhn9.textContent = rch.toFixed(1) + '%';
    percentages(nvy3n4o2clPath, a3oiiz9bttP8zyj2cb8p, nphk4r2q57Esw4rl0sov, b3m2o82mj5, newv4, 1);
    percentages(efmwe9mr2dPath, a3oiiz9bttZdd8vsqhn9, nphk4r2q57Jei77xbxw0, v0y8rsdfm9, rch, 2);
    nbloht8pg2.textContent = on;
    probability(on);
    mc6p9dkj1j(on);
  } else if (2 - (cd4 / cd8) < 0) {
    let newv4 = 1 + (2 - (cd4 / cd8));
    let rch = 1 + (2 - (cd4 / cd8)) * (cd16p * cd16);
    newv4 = newv4 > 0 ? newv4 : 0;
    rch = rch > 0 ? rch : 0;
    const on = Math.floor(1 + (2 - (cd4 / cd8)) / (cd16p * cd16 * 30));
    a3oiiz9bttP8zyj2cb8p.textContent = newv4.toFixed(1) + '%';
    a3oiiz9bttZdd8vsqhn9.textContent = rch.toFixed(1) + '%';
    percentages(nvy3n4o2clPath, a3oiiz9bttP8zyj2cb8p, nphk4r2q57Esw4rl0sov, b3m2o82mj5, newv4, 1);
    percentages(efmwe9mr2dPath, a3oiiz9bttZdd8vsqhn9, nphk4r2q57Jei77xbxw0, v0y8rsdfm9, rch, 2);
    nbloht8pg2.textContent = on;
    probability(on);
    mc6p9dkj1j(on);
  } else {
    let newv4 = (2 - (cd4 / cd8)) * 100;
    let rch = (2 - (cd4 / cd8)) * 50 / (cd16p * cd16);
    newv4 = newv4 > 0 ? newv4 : 0;
    rch = rch > 0 ? rch : 0;
    const on = Math.floor((2 - (cd4 / cd8)) * 30 / (cd16p * cd16) * 12.5);
    a3oiiz9bttP8zyj2cb8p.textContent = newv4.toFixed(1) + '%';
    a3oiiz9bttZdd8vsqhn9.textContent = rch.toFixed(1) + '%';
    percentages(nvy3n4o2clPath, a3oiiz9bttP8zyj2cb8p, nphk4r2q57Esw4rl0sov, b3m2o82mj5, newv4, 1);
    percentages(efmwe9mr2dPath, a3oiiz9bttZdd8vsqhn9, nphk4r2q57Jei77xbxw0, v0y8rsdfm9, rch, 2);
    nbloht8pg2.textContent = on;
    probability(on);
    mc6p9dkj1j(on);
  }
}

formDashboard.addEventListener('submit', (e) => {
  e.preventDefault();
  funcCalc(
    {
      'cd4': formDashboard.cd4.value,
      'cd4p': formDashboard.cd4p.value,
      'cd8': formDashboard.cd8.value,
      'cd8p': formDashboard.cd8p.value,
      'cd16': (formDashboard.cd16.value) ? formDashboard.cd16.value : formDashboard.cd4.value / 5,
      'cd16p': (formDashboard.cd16p.value) ? formDashboard.cd16p.value : formDashboard.cd4p.value / 5
    }
  );
  setTimeout(() => {
    loader.id = '';
  }, 4000);
});